<u:UrsaWindow
    x:Class="LabelPlus_Next.Tools.Views.MainWindow"
    xmlns="https://github.com/avaloniaui"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:m="clr-namespace:LabelPlus_Next.Tools.Models"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:u="https://irihi.tech/ursa"
    xmlns:v="clr-namespace:LabelPlus_Next.Tools.Views"
    xmlns:vm="clr-namespace:LabelPlus_Next.Tools.ViewModels"
    Title="WebDAV Tools"
    Width="1400"
    Height="900"
    d:DesignHeight="600"
    d:DesignWidth="1400"
    x:DataType="vm:MainWindowViewModel"
    Icon="avares://LabelPlus_Next.Tools/Assets/LabelPlus_Next_rounded_icon_transparent.ico"
    mc:Ignorable="d">

    <Design.DataContext>
        <vm:MainWindowViewModel />
    </Design.DataContext>

    <TabControl Margin="25">
        <TabItem Header="WebDAV">
            <Grid Margin="0,35,0,0" RowDefinitions="Auto,*,Auto">
                <!--  Top controls (two lines)  -->
                <StackPanel Spacing="6">
                    <!--  Line 1  -->
                    <StackPanel Orientation="Horizontal" Spacing="8">
                        <TextBlock VerticalAlignment="Center" Text="BaseUrl" />
                        <TextBox Width="420" Text="{Binding BaseUrl}" />

                        <Button Command="{Binding ConnectCommand}" Content="Connect" />
                        <Button Command="{Binding RefreshCommand}" Content="⭮" />
                        <Button Content="设置服务器" Click="OnOpenSettings" />
                        <Button Content="API上传" Click="OnApiUploadClick"/>
                    </StackPanel>
                    <!--  Line 2  -->
                    <StackPanel Orientation="Horizontal" Spacing="8">
                        <TextBlock VerticalAlignment="Center" Text="User" />
                        <TextBox Width="160" Text="{Binding Username}" />
                        <TextBlock VerticalAlignment="Center" Text="Password" />
                        <TextBox Width="160" Text="{Binding Password}" />
                        <TextBlock VerticalAlignment="Center" Text="TargetPath" />
                        <TextBox Width="240" Text="{Binding TargetPath}" />
                        <Button Click="OnUploadToFolderClick" Content="Upload to selected" />
                        <Button Click="OnUploadClick" Content="Upload (root)" />
                    </StackPanel>
                </StackPanel>

                <TreeView
                    x:Name="Tree"
                    Grid.Row="1"
                    ItemsSource="{Binding Nodes}">
                    <TreeView.DataTemplates>
                        <TreeDataTemplate x:DataType="m:DavNode" ItemsSource="{Binding Children}">
                            <StackPanel Orientation="Horizontal" Spacing="6">
                                <TextBlock Text="{Binding Name}" />
                                <TextBlock
                                    Foreground="Gray"
                                    Opacity="0.6"
                                    Text="{Binding Uri}" />
                            </StackPanel>
                        </TreeDataTemplate>
                    </TreeView.DataTemplates>
                </TreeView>

                <!--  Status  -->
                <TextBlock Grid.Row="2" Text="{Binding Status}" />
            </Grid>
        </TabItem>
        <TabItem Header="打包发布">
            <v:PackTabView />
        </TabItem>
    </TabControl>
</u:UrsaWindow>